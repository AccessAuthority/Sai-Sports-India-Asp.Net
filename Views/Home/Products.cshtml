@model IEnumerable<SaiSports.Models.tbl_products>
@{
	ViewData["Title"] = "Products";
	Layout = "_Layout";
}
<style>
    .p-content > p{
        font-size:14px;
    }
    .view{
        margin-top:10px;
        font-size: 14px;
        padding: 5px;
        width:fit-content;
        border: 1px dashed #dddd;
    }
    .cate-title{
        font-size: 20px;
        border:none !important;
        font-weight: 550;
    }
    .main-content {
        display: flex;
        justify-content:center !important;
        /* gap: 20px; */
        width: 100%;
    }

    .sidebar {
        margin-top: 10px;
        border-radius: 5px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        height: fit-content;
        width: 20%;
        border: 1px solid #dddd;
        padding: 10px;
        top: 100px !important;
        position: sticky;
    }

    .searchbar {
        border-radius: 5px;
        width: 100%;
        height: 40px;
        border: 1px solid #dddd;
        padding: 5px;
        input

    {
        height: 100%;
        width: 100%;
        background-color: transparent;
        border: none;
        outline: none;
        color: #dddd;
        padding-left: 5px;
    }

    }

    .category {
        display: flex;
        flex-direction: column;
        gap: 10px;
        height: auto;
        width: 100%;
        p

    {
        display: flex;
        padding: 5px;
        gap: 10px;
        align-items: center;
        border: 1px solid #dddd;
        input

    {
        height: 20px;
        width: 20px;
    }

    }
    }

    .p-cards {
        justify-content: center;
        flex-wrap: wrap;
        width: 80%;
    }

    .p-card {
        width: 458px;
    }
    /* Modal styles */
    .modal {
        display: none;
        position: fixed;
        z-index: 10;
        left: 0;
        top: 100px;
        width: 100%;
        height: 100vh;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4);
    }

    .modal-content {
        border-radius: 10px;
        background-color: rgba(0, 0, 0, 0.9);
        margin: 0 auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
        max-width: 500px;
        position: relative;
    }

        .modal-content > h2 {
            margin-bottom: 15px;
        }

    .close {
        color: #aaa;
        font-size: 28px;
        font-weight: bold;
        position: absolute;
        top: 10px;
        right: 25px;
    }

        .close:hover,
        .close:focus {
            color: white;
            text-decoration: none;
            cursor: pointer;
        }


    /* Style for the bottom close button */
    .close-btn {
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 20px;
        width: 100%;
    }

    input,
    .qt-btn {
        color: #fff;
        border: 1px solid #dddd;
        padding: 5px;
        border-radius: 5px;
        outline: none;
        height: 40px;
        width: 100%;
        font-size: 16px;
        background-color: transparent;
    }

    .ellipsis-2 {
        font-size:15px;
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .ellipsis-4 {
        font-size: 14px;
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 4;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    @@media (max-width: 768px) {
        .quote-btn{
            width: 120px;
            /* margin-right: -30px; */
        }
    .main-content {
        flex-direction: column;
        justify-content: center;
    }
    .sidebar {
        display: none;
    }
    .p-cards{
        width:100%;
    }
    }
</style>
<Section class="dark-section">
    <div class="section-content">
        <div class="breadcrumb">
            <h2>Our Products</h2>
            <a asp-action="Index">Home</a> <span>></span> <a>Products</a>
        </div>
    </div>
    <div class="section-content">
        <div class="main-content">
            <div class="sidebar">
                <div class="searchbar">
                    <input type="text" id="searchInput" placeholder="Search Here" onkeyup="searchAndFilter()">
                </div>
                <div class="category">
                    <p class="cate-title">Category</p>
                    <p>
                        <input type="checkbox" id="categoryTrackSuits" onchange="searchAndFilter()"> Track Suits
                    </p>
                    <p>
                        <input type="checkbox" id="categoryTShirt" onchange="searchAndFilter()"> T-Shirt
                    </p>
                    <p>
                        <input type="checkbox" id="categoryBlazer" onchange="searchAndFilter()"> Blazer
                    </p>
                    <p>
                        <input type="checkbox" id="categoryJacket" onchange="searchAndFilter()"> Jacket
                    </p>
                    <p>
                        <input type="checkbox" id="categoryShirts" onchange="searchAndFilter()"> Shirts
                    </p>
                    <p>
                        <input type="checkbox" id="categoryShorts" onchange="searchAndFilter()"> Shorts
                    </p>
                    <p>
                        <input type="checkbox" id="categoryMedical" onchange="searchAndFilter()"> Medical
                    </p>
                    <p>
                        <input type="checkbox" id="categorySafetyUniform" onchange="searchAndFilter()"> Safety Uniform
                    </p>
                    <p>
                        <input type="checkbox" id="categorySweater" onchange="searchAndFilter()"> Sweater
                    </p>
                </div>
                <div class="category">
                    <p class="cate-title">Fabrics</p>
                    <p>
                        <input type="checkbox" id="fabricCombedCotton" onchange="searchAndFilter()"> Combed Cotton
                    </p>
                    <p>
                        <input type="checkbox" id="fabricCombedPolyCottonPiqueKnit" onchange="searchAndFilter()"> Combed PolyCotton
                    </p>
                    <p>
                        <input type="checkbox" id="fabricPolyCottonPiqueKnit" onchange="searchAndFilter()"> PolyCotton Pique Knit
                    </p>
                    <p>
                        <input type="checkbox" id="fabricKooltronPolyCotton" onchange="searchAndFilter()"> Kooltron PolyCotton
                    </p>
                    <p>
                        <input type="checkbox" id="fabricMiniMattPolyester" onchange="searchAndFilter()"> Mini Matt Polyester
                    </p>
                </div>

            </div>
            <div class="p-cards" id="productCards">
                @foreach(var product in Model)
                {
                    <div class="p-card" data-title="@product.pname" data-category="@product.pcategory" data-description="@product.pdesc" data-fabric="@product.fabric">
                        <div class="img">
                            <img src="~/upload/@product.img1" alt="@product.pname">
                        </div>
                        <div class="p-content">
                            <a href="@Url.Action("ProductDetails", "Home", new { id = product.id })"><h3 class="text-white ellipsis-2">@product.pname</h3></a>
                            <p><strong>Fabric:</strong> @product.fabric</p>
                            <p><strong>Style:</strong>  @product.style</p>
                            <p><strong>Size:</strong>  @product.size</p>
                            <p class="text-white ellipsis-4">@product.pdesc</p>
                            <a href="@Url.Action("ProductDetails", "Home", new { id = product.id })" class="view">View More..</a>
                        </div>
                        @* <button class="cta-link-dark quote-btn" onclick="openModal()">Get Quote</button> *@
                    </div>
                }
            </div>
            <!-- The Modal -->
            <div id="quoteModal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeModal()">&times;</span>
                    <h2>Get Your Quote</h2>

                    <!-- Success Message (hidden initially) -->
                    <div id="successMessage" style="display:none; color: green; text-align: center;">
                        <p>Thank you! Your request has been successfully submitted.</p>
                    </div>

                    <form id="quoteForm" asp-action="EnquiryForm" method="post">
                        <input type="text" id="name" name="name" required placeholder="Enter Your Name">
                        <br><br>
                        <input type="text" id="name" name="phone" required placeholder="Enter Your Number" maxlength="10">
                        <br><br>
                        <input type="email" id="email" name="email" required placeholder="Enter Your Email">
                        <br><br>
                        <input type="text" id="sub" name="subject" required placeholder="Enter Subject">
                        <br><br>
                        <input id="quoteDetails" name="msg" required
                               placeholder="Enter Quote Details">
                        <br><br>
                        <button type="submit" class="qt-btn">Submit</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</Section>

<script>

     // Function to open the modal
    function openModal() {
        document.getElementById("quoteModal").style.display = "block";
    }

    // Function to close the modal
    function closeModal() {
        document.getElementById("quoteModal").style.display = "none";
    }

    // Close the modal if the user clicks outside of it
    window.onclick = function(event) {
        if (event.target === document.getElementById("quoteModal")) {
            closeModal();
        }
    }

    // Handle form submission
    document.getElementById("quoteForm").addEventListener("submit", function(event) {
        // Assuming the form submission is handled by ASP.NET on the server
        // event.preventDefault();  Prevent the default form submission

        // Simulate a successful form submission (replace this with actual form submission)
        setTimeout(function() {
            // Hide the form and show the success message
            document.querySelector("form").style.display = "none";
            document.getElementById("successMessage").style.display = "block";
        }, 300); // Simulated delay, replace with actual server-side handling
    });

            // Filter And Search
    function searchAndFilter() {
        // Get the search query value
        const searchQuery = document.getElementById('searchInput').value.toLowerCase();

        // Get selected categories
        const categoryTrackSuits = document.getElementById('categoryTrackSuits').checked;
        const categoryTShirt = document.getElementById('categoryTShirt').checked;
        const categoryBlazer = document.getElementById('categoryBlazer').checked;
        const categoryJacket = document.getElementById('categoryJacket').checked;
        const categoryShirts = document.getElementById('categoryShirts').checked;
        const categoryShorts = document.getElementById('categoryShorts').checked;
        const categoryMedical = document.getElementById('categoryMedical').checked;
        const categorySafetyUniform = document.getElementById('categorySafetyUniform').checked;
        const categorySweater = document.getElementById('categorySweater').checked;

        // Get selected fabrics
        const selectedFabrics = [];
        if (document.getElementById('fabricCombedCotton').checked) selectedFabrics.push('Combed Cotton');
        if (document.getElementById('fabricCombedPolyCottonPiqueKnit').checked) selectedFabrics.push('Combed PolyCotton Pique Knit');
        if (document.getElementById('fabricPolyCottonPiqueKnit').checked) selectedFabrics.push('PolyCotton Pique Knit');
        if (document.getElementById('fabricKooltronPolyCotton').checked) selectedFabrics.push('Kooltron PolyCotton');
        if (document.getElementById('fabricMiniMattPolyester').checked) selectedFabrics.push('Mini Matt Polyester');

        // Get all product cards
        const productCards = document.querySelectorAll('.p-card');

        // Loop through each product card and apply search and filter logic
        productCards.forEach(card => {
            const productTitle = card.getAttribute('data-title').toLowerCase();
            const productCategory = card.getAttribute('data-category').toLowerCase();
            const productDescription = card.getAttribute('data-description').toLowerCase();
            const productFabric = card.getAttribute('data-fabric');

            // Check if the product matches the search query
            const matchesSearch = productTitle.includes(searchQuery) || productDescription.includes(searchQuery);

            // Check if the product matches selected categories
            const matchesCategory =
                (categoryTrackSuits && productCategory.includes('track suits')) ||
                (categoryTShirt && productCategory.includes('t-shirt')) ||
                (categoryBlazer && productCategory.includes('blazer')) ||
                (categoryJacket && productCategory.includes('jacket')) ||
                (categoryShirts && productCategory.includes('shirts')) ||
                (categoryShorts && productCategory.includes('shorts')) ||
                (categoryMedical && productCategory.includes('medical')) ||
                (categorySafetyUniform && productCategory.includes('safety uniform')) ||
                (categorySweater && productCategory.includes('sweater')) ||
                (!categoryTrackSuits && !categoryTShirt && !categoryBlazer && !categoryJacket && !categoryShirts && !categoryShorts && !categoryMedical && !categorySafetyUniform && !categorySweater); // If no category is selected, show all

            // Check if the product matches selected fabrics
            const matchesFabric = selectedFabrics.length === 0 || selectedFabrics.includes(productFabric);

            // Show or hide the product card based on matches
            if (matchesSearch && matchesCategory && matchesFabric) {
                card.style.display = ''; // Show card
            } else {
                card.style.display = 'none'; // Hide card
            }
        });
    }

</script>
